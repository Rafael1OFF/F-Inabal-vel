<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Fé Inabalável | Plataforma de Formação</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* BASE & VARIÁVEIS PREMIUM E SÓBRIAS */
        :root {
            --bg-color: #f8fafc; --surface: #ffffff; --sidebar-bg: #0f172a;
            --text-main: #334155; --text-heading: #0f172a;
            --primary: #b45309; --primary-hover: #92400e;
            --secondary: #1e293b; --border: #e2e8f0;
            --danger: #b91c1c; --success: #15803d;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-main); line-height: 1.8; -webkit-font-smoothing: antialiased; }

        /* TELA DE LOGIN / ACESSO */
        #login-screen { position: fixed; inset: 0; background: var(--sidebar-bg); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 2rem; overflow-y: auto; }
        .login-box { background: var(--surface); max-width: 500px; width: 100%; padding: 4rem 3rem; border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); text-align: center; }
        .login-box h1 { font-family: 'Merriweather', serif; font-size: 2.2rem; color: var(--text-heading); margin-bottom: 0.5rem; }
        .login-box p { color: #64748b; margin-bottom: 2.5rem; font-size: 1.1rem; }
        .form-group { margin-bottom: 1.5rem; text-align: left; }
        .form-group label { display: block; font-weight: 800; margin-bottom: 0.5rem; color: var(--secondary); text-transform: uppercase; font-size: 0.9rem; letter-spacing: 0.5px; }
        .form-group input { width: 100%; padding: 1.2rem; border: 2px solid var(--border); border-radius: 8px; font-size: 1.1rem; font-family: 'Inter', sans-serif; transition: border-color 0.3s; }
        .form-group input:focus { outline: none; border-color: var(--primary); }
        .btn-login { background: var(--primary); color: white; border: none; padding: 1.2rem; width: 100%; border-radius: 8px; font-size: 1.1rem; font-weight: 800; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; margin-top: 1rem; }

        /* ESTRUTURA RESPONSIVA DO CURSO */
        #app-layout { display: none; flex-direction: column; min-height: 100vh; }
        .mobile-header { display: none; background: var(--sidebar-bg); color: white; padding: 1rem 1.5rem; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 50; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .menu-toggle { background: none; border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.4rem 0.8rem; border-radius: 4px; font-size: 0.8rem; font-weight: 800; cursor: pointer; text-transform: uppercase; }

        /* SIDEBAR */
        .sidebar { width: 280px; background-color: var(--sidebar-bg); color: white; height: 100vh; position: fixed; left: 0; top: 0; padding: 2rem 1.5rem; overflow-y: auto; transition: transform 0.3s ease; z-index: 40; display: flex; flex-direction: column; }
        .sidebar-header { border-bottom: 1px solid #334155; padding-bottom: 1.5rem; margin-bottom: 2rem; }
        .sidebar-header h2 { font-size: 1.2rem; font-weight: 800; letter-spacing: 1px; color: #f8fafc; text-transform: uppercase; }
        .student-info { background: #1e293b; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; font-size: 0.9rem; border-left: 3px solid var(--primary); }
        .student-info strong { display: block; color: white; font-size: 1rem; }

        .nav-btn { display: block; width: 100%; text-align: left; background: transparent; color: #94a3b8; border: none; padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; font-size: 0.95rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .nav-btn:hover:not(.locked) { background: rgba(255,255,255,0.05); color: white; }
        .nav-btn.active { background: var(--primary); color: white; }
        .nav-btn.locked { opacity: 0.4; cursor: not-allowed; }
        
        .sync-box { margin-top: auto; padding-top: 2rem; text-align: center; }
        .sync-code-display { background: black; color: #10b981; padding: 0.8rem; border-radius: 4px; font-family: monospace; font-size: 1rem; font-weight: bold; margin-top: 0.5rem; word-break: break-all; }

        /* CONTEÚDO PRINCIPAL */
        .main-content { margin-left: 280px; padding: 4rem; max-width: 1000px; width: 100%; margin-right: auto; }
        .module-section { display: none; animation: fadeIn 0.5s ease; }
        .module-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* TIPOGRAFIA DO TEXTO */
        .kicker { font-size: 0.9rem; color: var(--primary); font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; display: block; margin-bottom: 0.5rem; }
        h1 { font-family: 'Merriweather', serif; font-size: 2.8rem; color: var(--text-heading); line-height: 1.3; margin-bottom: 2rem; }
        h2 { font-size: 1.8rem; color: var(--secondary); margin: 4rem 0 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border); }
        p { font-size: 1.15rem; margin-bottom: 1.8rem; color: #475569; text-align: justify; }

        /* CAIXAS BÍBLICAS NVI */
        .bible-box { background: #fffbeb; border-left: 4px solid var(--primary); padding: 2.5rem; margin: 3rem 0; border-radius: 0 12px 12px 0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .bible-text { font-family: 'Merriweather', serif; font-size: 1.3rem; font-style: italic; color: #1e293b; line-height: 1.7; }
        .bible-ref { display: block; margin-top: 1.5rem; font-family: 'Inter', sans-serif; font-size: 0.9rem; font-weight: 800; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }

        /* PASSO A PASSO RIGOROSO */
        .step-box { background: #f8fafc; border: 1px solid var(--border); border-top: 4px solid var(--secondary); border-radius: 8px; padding: 2.5rem; margin: 3rem 0; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05); }
        .step-box h4 { color: var(--secondary); font-size: 1.3rem; margin-bottom: 1.5rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 800; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .step-list { list-style-type: none; counter-reset: step-counter; margin-left: 0; }
        .step-list li { counter-increment: step-counter; margin-bottom: 1.8rem; position: relative; padding-left: 3.5rem; font-size: 1.1rem; color: #334155; text-align: justify; }
        .step-list li:last-child { margin-bottom: 0; }
        .step-list li::before { content: counter(step-counter); position: absolute; left: 0; top: 0; background: var(--secondary); color: white; width: 2.2rem; height: 2.2rem; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 1rem; font-weight: 800; }
        .step-list li strong { color: var(--text-heading); display: block; margin-bottom: 0.5rem; font-size: 1.15rem; }

        /* BOTÕES DE AVALIAÇÃO */
        .btn { background: var(--primary); color: white; border: none; padding: 1.2rem 2rem; border-radius: 8px; font-size: 1.1rem; font-weight: 800; cursor: pointer; transition: all 0.3s; width: 100%; display: block; text-align: center; margin-top: 4rem; text-transform: uppercase; letter-spacing: 1px; }
        .btn-success { background: var(--success); }
        
        /* TELA DE AVALIAÇÃO */
        #eval-modal { display: none; position: fixed; inset: 0; background: var(--bg-color); z-index: 100; overflow-y: auto; padding: 2rem 1rem; }
        .eval-container { max-width: 800px; margin: 0 auto; background: var(--surface); border-radius: 12px; padding: 3rem; border: 1px solid var(--border); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.1); }
        .question-card { margin-bottom: 2.5rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border); }
        .question-title { font-size: 1.2rem; font-weight: 600; color: var(--secondary); margin-bottom: 1.5rem; line-height: 1.5; }
        .option-lbl { display: flex; align-items: flex-start; padding: 1.2rem; margin-bottom: 0.8rem; background: #f8fafc; border: 1px solid var(--border); border-radius: 8px; cursor: pointer; font-size: 1.05rem; line-height: 1.5; }
        .option-lbl input { margin-right: 15px; margin-top: 5px; width: 20px; height: 20px; accent-color: var(--primary); flex-shrink: 0; }

        /* RESULTADOS SALVOS LOCAIS */
        .result-card { background: white; border: 1px solid var(--border); border-radius: 8px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .result-header { border-bottom: 2px solid #e2e8f0; padding-bottom: 1rem; margin-bottom: 1.5rem; }
        .result-score { font-size: 2rem; font-weight: 800; color: var(--primary); }
        .result-q { font-weight: 600; margin-bottom: 0.5rem; margin-top: 1.5rem; }
        .result-a.correct { color: var(--success); font-weight: bold; background: #f0fdf4; padding: 0.5rem; border-radius: 4px; }
        .result-a.incorrect { color: var(--danger); font-weight: bold; background: #fef2f2; padding: 0.5rem; border-radius: 4px; }

        /* CERTIFICADO INVISÍVEL PARA GERAÇÃO DE PDF */
        #certificado-wrapper { display: none; padding: 40px; background: white; width: 1123px; height: 794px; position: absolute; left: -9999px; top: 0; }
        .certificado-content { border: 10px solid var(--secondary); padding: 50px; text-align: center; height: 100%; border-radius: 10px; background: #f8fafc; position: relative; }
        .cert-title { font-family: 'Merriweather', serif; font-size: 4rem; color: var(--primary); text-transform: uppercase; letter-spacing: 5px; margin-top: 30px; }
        .cert-subtitle { font-size: 1.5rem; color: #64748b; margin-top: 10px; letter-spacing: 2px; }
        .cert-name { font-family: 'Merriweather', serif; font-size: 3.5rem; font-weight: bold; color: var(--text-heading); margin: 60px 0; border-bottom: 2px solid var(--primary); display: inline-block; padding: 0 50px; }
        .cert-body { font-size: 1.5rem; color: #334155; max-width: 800px; margin: 0 auto; line-height: 1.8; }
        .cert-footer { position: absolute; bottom: 50px; width: 100%; left: 0; display: flex; justify-content: space-around; font-size: 1.2rem; color: var(--secondary); font-weight: bold; }
        .cert-signature { border-top: 2px solid var(--secondary); padding-top: 10px; width: 300px; }

        @media (max-width: 768px) {
            .mobile-header { display: flex; }
            .sidebar { transform: translateX(-100%); width: 280px; }
            .sidebar.open { transform: translateX(0); box-shadow: 4px 0 15px rgba(0,0,0,0.5); }
            .main-content { margin-left: 0; padding: 2rem 1.5rem; }
            h1 { font-size: 2.2rem; }
            .login-box { padding: 2.5rem 1.5rem; }
            .eval-container { padding: 1.5rem; }
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h1>A FÉ INABALÁVEL</h1>
            <p>Formação de Caráter e Teologia</p>
            <div class="form-group"><label>Seu Nome Completo</label><input type="text" id="login-nome" required></div>
            <div class="form-group"><label>Sua Função na Igreja</label><input type="text" id="login-funcao" required></div>
            <div class="form-group" style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e2e8f0;">
                <label style="color: #64748b;">Chave de Acesso Criptografada (Opcional)</label>
                <input type="text" id="login-chave" placeholder="Cole sua chave anti-fraude aqui">
            </div>
            <p id="login-err" style="color: var(--danger); font-weight: 800; display: none; margin-top: 1rem;"></p>
            <button class="btn-login" onclick="entrarNoCurso()">Acessar Plataforma</button>
        </div>
    </div>

    <div id="app-layout" class="layout">
        <header class="mobile-header">
            <span style="font-weight: 800; font-size: 1.2rem;">A FÉ INABALÁVEL</span>
            <button class="menu-toggle" onclick="toggleMenu()">MENU</button>
        </header>

        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header"><h2>A Forja</h2><span>Formação de Caráter</span></div>
            <div class="student-info">Aluno: <strong id="display-nome">Nome</strong><span id="display-funcao" style="color:#94a3b8;">Função</span></div>
            
            <nav>
                <button id="nav-mod-disciplina" class="nav-btn active" onclick="switchTab('mod-disciplina')">1. A Disciplina</button>
                <button id="nav-mod-conhecimento" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-conhecimento', this)">2. Conhecimento (Cadeado)</button>
                <button id="nav-mod-conviccao" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-conviccao', this)">3. Convicção (Cadeado)</button>
                <button id="nav-mod-constancia" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-constancia', this)">4. Constância (Cadeado)</button>
                <button id="nav-mod-autocontrole" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-autocontrole', this)">5. Autocontrole (Cadeado)</button>
                <button id="nav-mod-comunhao" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-comunhao', this)">6. Comunhão (Cadeado)</button>
                <button id="nav-mod-perseveranca" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-perseveranca', this)">7. Perseverança (Cadeado)</button>
                <hr style="border: 0; border-top: 1px solid #334155; margin: 15px 0;">
                <button id="nav-mod-resultados" class="nav-btn" onclick="switchTab('mod-resultados')" style="color: #cbd5e1; font-weight: bold;">Resultados e Provas</button>
                <button id="nav-mod-exame" class="nav-btn locked" onclick="switchTabIfUnlocked('mod-exame', this)" style="background: var(--danger); color: white;">Exame Final (Cadeado)</button>
            </nav>

            <div class="sync-box">
                <span style="font-size: 0.8rem; color: #94a3b8; text-transform: uppercase; font-weight: bold;">Chave Anti-Fraude Gerada</span>
                <div class="sync-code-display" id="display-chave">NENHUMA</div>
            </div>
        </aside>

        <main class="main-content">
            
            <section id="mod-disciplina" class="module-section active">
                <span class="kicker">Pilar 01</span>
                <h1>A Forja da Disciplina: Onde o Caráter é Moldado</h1>
                
                <p>Muitos cristãos querem viver milagres extraordinários, mas fogem do processo doloroso e ordinário que os prepara para isso. Querem ser fortes na fé, mas sentem preguiça de dobrar os joelhos para orar; querem ter sabedoria, mas evitam a leitura profunda da Bíblia. A verdade nua e crua é que uma fé inabalável não cai do céu pronta. Ela precisa ser forjada, batida e moldada sob forte calor.</p>
                <p>Neste primeiro pilar, você aprenderá que a disciplina é a fundação de tudo. Sem ela, o conhecimento que você vai adquirir nos próximos módulos será inútil, pois você não terá forças para colocá-lo em prática.</p>

                <h2>1. A Natureza da Disciplina e a Ilusão da Motivação</h2>
                <p>A palavra "disciplina" assusta porque, na nossa cultura, ela parece um castigo opressivo. Mas, na época bíblica, ela significava o treinamento de um soldado. A disciplina é a única ferramenta capaz de te manter de pé quando a emoção acabar.</p>
                <p>Motivação é um sentimento baseado no humor. Você sai de um culto de domingo super motivado para ler a Bíblia todos os dias. No entanto, na terça-feira chuvosa, após um dia estressante de trabalho, essa vontade desaparece completamente. A disciplina, por outro lado, não liga para a sua vontade. Ela é baseada em um <strong>compromisso racional e inegociável</strong> com Deus. Pense em Jesus: em Marcos 1:35, a Bíblia relata que Ele levantava de madrugada, quando ainda estava escuro, e ia para um lugar deserto orar. Ele não fazia isso apenas quando "sentia vontade"; Ele fazia porque a disciplina da oração era inegociável para Sua missão.</p>
                
                <div class="bible-box">
                    <p class="bible-text">"Quem ama a disciplina ama o conhecimento, mas o que odeia a repreensão é tolo."</p>
                    <span class="bible-ref">Provérbios 12:1 (NVI 2020)</span>
                </div>

                <div class="step-box">
                    <h4>Passo a Passo: Vencendo a Falsa Motivação</h4>
                    <ul class="step-list">
                        <li><strong>A Regra dos 5 Segundos:</strong> Quando o despertador tocar pela manhã para você orar ou levantar para o trabalho, não pense. A mente carnal sempre buscará o conforto da cama. Portanto, conte agressivamente: 5, 4, 3, 2, 1 e jogue as cobertas para o lado. Aja antes que a sua mente te convença a desistir.</li>
                        <li><strong>Estabeleça o Mínimo Inegociável:</strong> Defina uma meta pequena, porém absoluta. Exemplo: "Eu vou ler 1 capítulo da Bíblia por dia, quer eu esteja feliz, triste, cansado ou motivado". A disciplina começa no básico.</li>
                    </ul>
                </div>

                <h2>2. A Forja Física e Espiritual: O Domínio da Carne</h2>
                <p>Nós somos formados por espírito, alma e corpo. E o nosso corpo tem vontades próprias, que a Bíblia chama de "carne". A carne quer dormir até o meio-dia, quer consumir açúcar e quer rolar o feed do celular infinitamente recebendo prazer imediato. O apóstolo Paulo comparou a vida com Deus ao esporte de alto rendimento para explicar como devemos lidar com essas vontades.</p>
                
                <div class="bible-box">
                    <p class="bible-text">"Mas esmurro o meu próprio corpo e faço dele meu escravo, para que, depois de ter pregado aos outros, eu mesmo não venha a ser reprovado."</p>
                    <span class="bible-ref">1 Coríntios 9:27 (NVI 2020)</span>
                </div>

                <p>O que significa "esmurrar o próprio corpo"? Não é se machucar fisicamente. Paulo está falando de <strong>subjugação da vontade</strong>. É você olhar para o seu próprio corpo quando ele exige conforto e dizer: "Quem manda na minha rotina e nas minhas decisões não são os meus instintos, mas o Espírito Santo de Deus que habita em mim". Veja o exemplo do profeta Daniel: quando ele chegou à Babilônia, ele decidiu firmemente não se contaminar com a comida rica do rei (Daniel 1:8). Ele dominou o apetite do seu próprio corpo para não quebrar seus princípios espirituais.</p>

                <div class="step-box">
                    <h4>Passo a Passo: O Jejum de Prazeres Lícitos</h4>
                    <ul class="step-list">
                        <li><strong>Identifique o Senhor da sua Rotina:</strong> Escolha algo que não é pecado, mas que rouba a maior parte do seu tempo diário (ex: redes sociais, televisão, jogos de celular, ou até mesmo açúcar/café).</li>
                        <li><strong>O Corte Estratégico:</strong> Fique exatos 3 dias inteiros sem consumir absolutamente nada desse item. O seu corpo entrará em abstinência. Sua mente tentará te convencer a olhar "só um pouquinho".</li>
                        <li><strong>O Redirecionamento da Frustração:</strong> Quando a vontade bater forte, feche os olhos por 1 minuto e faça uma oração objetiva: "Senhor, a minha carne quer isso agora, mas eu declaro que o meu espírito tem mais fome de Ti do que o meu corpo tem desse prazer". Esse exercício fortalece o músculo do seu autocontrole como nenhuma outra prática.</li>
                    </ul>
                </div>

                <h2>3. Disciplina Sob Pressão e a Constância na Crise</h2>
                <p>É fácil ser disciplinado quando a vida está calma e o contracheque está na conta. Mas a verdadeira disciplina se revela na hora do caos. Voltemos a Daniel. Anos depois da dieta, o rei da Babilônia assinou um decreto de morte: quem fosse pego orando a qualquer deus seria jogado na cova dos leões. A pressão era mortal.</p>
                <p>O que Daniel fez? Ele não se escondeu com medo, nem mudou sua rotina. A Bíblia relata em Daniel 6:10 que ele foi para o seu quarto e orou <strong>"como costumava fazer"</strong>. Ele orava três vezes ao dia. A disciplina que ele construiu na paz serviu como uma armadura na guerra. Se ele tivesse que inventar coragem e buscar a Deus apenas na hora do desespero, ele teria cedido ao decreto. O hábito inquebrável o tornou inabalável diante da morte.</p>

                <div class="step-box">
                    <h4>Passo a Passo: O Alarme de Alinhamento de Daniel</h4>
                    <ul class="step-list">
                        <li><strong>O Alarme Tríplice:</strong> Configure 3 alarmes no seu celular durante o dia comercial (ex: 09h00, 14h00, 18h00).</li>
                        <li><strong>A Pausa do Caos:</strong> Quando o alarme tocar, não importa o quão estressante esteja o seu trabalho, pare o que estiver fazendo por exatos 2 minutos.</li>
                        <li><strong>A Oração de Conexão:</strong> Não use esse tempo para pedir coisas, mas para se alinhar: "Pai, estou no meio da correria do mundo, mas lembro que não pertenço a ele, pertenço a Ti. Guarda minha mente nas próximas horas".</li>
                    </ul>
                </div>

                <h2>4. O Processo Doloroso da Correção Divina</h2>
                <p>A disciplina de Deus nem sempre é um treinamento amigável; muitas vezes, ela vem em forma de correção dura quando erramos o alvo. O rei Davi adulterou com Bate-Seba e tentou esconder seu pecado. Deus o amava tanto que não o deixou impune. Deus enviou o profeta Natã para confrontá-lo (2 Samuel 12), e a disciplina que se seguiu trouxe dor severa à casa de Davi. No entanto, essa disciplina quebrou o orgulho de Davi e o levou ao arrependimento profundo (Salmo 51).</p>
                
                <div class="bible-box">
                    <p class="bible-text">"Nenhuma disciplina parece ser motivo de alegria no momento, mas sim de tristeza. Mais tarde, porém, produz fruto de justiça e paz para aqueles que por ela foram exercitados."</p>
                    <span class="bible-ref">Hebreus 12:11 (NVI 2020)</span>
                </div>
                
                <p>Quando passamos por dificuldades ou quando um líder espiritual maduro nos corrige apontando nossas falhas, nossa primeira reação instintiva é o orgulho: queremos nos defender ou fugir da igreja. Mas o segredo de quem tem o caráter forjado é a capacidade de <strong>permanecer na bigorna</strong>. Eles sabem que o martelo da correção não quer destruí-los, mas quer moldá-los à imagem de Cristo.</p>

                <div class="step-box">
                    <h4>Passo a Passo: Matando o Orgulho na Correção</h4>
                    <ul class="step-list">
                        <li><strong>Busque Prestação de Contas:</strong> Abrace um irmão mais maduro na fé. Sente-se com essa pessoa e confesse de forma clara qual área da sua vida está desorganizada ou em pecado.</li>
                        <li><strong>Dê Autoridade para a Correção:</strong> Peça para essa pessoa te cobrar sobre essa falha daqui a 15 dias. Quando ela te perguntar e apontar seu erro, engula o orgulho. Não se defenda, não dê desculpas. Apenas agradeça pela correção, arrependa-se e mude. O ego precisa morrer para o caráter nascer.</li>
                    </ul>
                </div>

                <button class="btn" onclick="iniciarProva('disciplina')">Realizar Prova do Pilar 1</button>
            </section>

            <section id="mod-conhecimento" class="module-section">
                <span class="kicker">Pilar 02</span>
                <h1>Conhecimento: A Fundação Racional da Fé</h1>
                
                <p>A disciplina pavimentou a estrada. Agora precisamos construir os alicerces sobre ela. O segundo pilar da Fé Inabalável é o <strong>Conhecimento</strong>. Existe um mito profundamente destrutivo (e infelizmente muito popular) na igreja moderna de que a fé deve ser "cega". Muitos ensinam que para ter fé basta desligar a inteligência, fechar os olhos e confiar na intuição ou no arrepio que se sente durante a música do culto.</p>

                <p>A Bíblia repudia essa ideia de ignorância. A verdadeira fé exige uma mente iluminada e afiada pela Palavra. Uma fé que não se baseia no conhecimento teológico correto de quem Deus é, das Suas alianças e das Suas promessas, é uma fé de papel. Ela será esmagada pelo primeiro argumento ateísta que você encontrar, ou pela primeira tragédia de saúde que atingir sua família.</p>

                <div class="bible-box">
                    <p class="bible-text">"Meu povo foi destruído por falta de conhecimento. Uma vez que vocês rejeitaram o conhecimento, eu também os rejeito como meus sacerdotes."</p>
                    <span class="bible-ref">Oséias 4:6 (NVI 2020)</span>
                </div>

                <h2>1. A Diferença entre Informação e o Conhecimento Relacional</h2>
                <p>É fundamental entender que a Bíblia não pede que você acumule dados históricos apenas para vencer discussões teológicas na internet. Os fariseus da época de Jesus sabiam a Lei de Moisés de cor, decoravam os profetas, mas quando o próprio Deus encarnado estava diante deles, eles não O reconheceram. Por quê? Porque eles tinham apenas informação intelectual fria.</p>
                <p>No idioma original da Bíblia, o conhecimento exigido é um <strong>conhecimento íntimo, relacional e de primeira mão</strong>. É impossível você confiar o seu dinheiro, os seus segredos e a sua vida nas mãos de um desconhecido que você encontrou na rua. Com Deus é a mesma coisa. Como você pode descansar e não se desesperar no dia em que perder o emprego, se a sua mente não tem a memória viva de como Deus sustentou o profeta Elias no deserto seco? O conhecimento correto abastece o motor da sua fé.</p>

                <div class="step-box">
                    <h4>Passo a Passo: O Método da Pergunta Textual</h4>
                    <ul class="step-list">
                        <li><strong>Pare de ler correndo:</strong> Ao abrir a Bíblia, não leia depressa apenas para marcar um "X" na sua meta de leitura. Pare, pegue um caderno e, ao terminar o capítulo, obrigue-se a escrever.</li>
                        <li><strong>Identifique o Caráter de Deus:</strong> Faça a si mesmo a pergunta vital: "O que este texto me ensina especificamente sobre como Deus age?". Ele foi um juiz implacável neste texto? Ele foi um Pai que perdoou uma falha terrível?</li>
                        <li><strong>A Oração Embasada:</strong> Transforme o que você anotou em oração. Exemplo: "Senhor, acabei de ler como Tu tiveste paciência com a teimosia do povo no deserto. Com base nesse conhecimento, peço que tenhas a mesma paciência com as minhas falhas de hoje".</li>
                    </ul>
                </div>

                <h2>2. A Ignorância como Arma do Inimigo no Deserto</h2>
                <p>A ignorância bíblica é o playground preferido de Satanás. Todo engano espiritual começa com uma meia-verdade. Foi assim no jardim do Éden, quando a serpente distorceu o que Deus havia falado. Milênios depois, Satanás tentou a mesma estratégia com o próprio Jesus Cristo.</p>
                <p>Em Mateus 4, quando Jesus estava exausto e vulnerável após 40 dias de jejum no deserto, Satanás não O atacou enviando monstros ou possessões; o Diabo O atacou com <strong>uma distorção teológica da própria Bíblia</strong>. O inimigo citou o Salmo 91 ("Ele dará ordens a seus anjos a seu respeito") para induzir Jesus a pular do templo em um ato de orgulho.</p>
                
                <p>Como Jesus Se defendeu? Ele não chamou um raio do céu. Ele puxou a espada do Conhecimento inquebrável. Jesus sabia que o Diabo estava isolando um versículo da Bíblia fora de seu contexto. E Jesus respondeu fechando a lacuna herege, usando o livro de Deuteronômio:</p>

                <div class="bible-box">
                    <p class="bible-text">"Jesus lhe respondeu: 'Também está escrito: Não ponha à prova o Senhor, o seu Deus'."</p>
                    <span class="bible-ref">Mateus 4:7 referenciando Deuteronômio 6:16 (NVI 2020)</span>
                </div>

                <p>A lição desta passagem é assustadora: <strong>Texto fora de contexto é pretexto para heresia.</strong> Se o Filho de Deus precisou ter o conhecimento total das Escrituras guardado em Sua mente para não ser enganado, é óbvio que você será derrotado pelas mentiras da vida se não estudar a fundo a Palavra.</p>

                <div class="step-box">
                    <h4>Passo a Passo: O Arsenal Mental Contra Tentações</h4>
                    <ul class="step-list">
                        <li><strong>Identifique o Ponto Cego:</strong> Qual é o pecado, o medo ou a emoção que mais te derrota constantemente? (Ansiedade com o futuro, ira descontrolada no trânsito, medo da solidão).</li>
                        <li><strong>Carregue a Arma:</strong> Pesquise e escolha 3 versículos na Bíblia que falem diretamente contra esse problema específico.</li>
                        <li><strong>A Fixação:</strong> Escreva esses versículos de forma legível em papéis e cole-os no espelho do banheiro ou no painel do carro. Você vai ler esses textos em voz alta todos os dias até memorizá-los. Quando a crise vier, você terá o mesmo poder de Cristo para declarar: "Também está escrito".</li>
                    </ul>
                </div>

                <h2>3. O Hábito de Ruminar e o Espírito Bereano</h2>
                <p>Vivemos na era da informação, mas sofremos de uma fome terrível de sabedoria teológica real. Muitos cristãos hoje passam horas consumindo vídeos de pregações sensacionalistas na internet que focam apenas em "vitória e sucesso", mas são incapazes de abrir a Bíblia e explicar doutrinas básicas.</p>
                <p>O livro de Atos 17:11 relata a visita do apóstolo Paulo à igreja da cidade de Bereia. Paulo era a maior autoridade teológica viva da época. Mesmo assim, os cristãos de Bereia foram chamados de pessoas com um "caráter nobre". Sabe por quê? Porque eles não ficavam gritando "amém" para tudo o que Paulo dizia de forma cega. A Bíblia diz que eles recebiam a palavra com alegria, mas depois <strong>"examinavam as Escrituras todos os dias para ver se o que Paulo dizia era verdade"</strong>. Eles conferiam as fontes.</p>

                <div class="step-box">
                    <h4>Passo a Passo: O Estudo Expositivo e o Filtro de Bereia</h4>
                    <ul class="step-list">
                        <li><strong>Abandone a Leitura Aleatória:</strong> Pare de abrir a Bíblia de forma mágica, apontar o dedo na página e esperar uma revelação isolada. A Bíblia é uma biblioteca rica em história. Você não entende um filme se começar a assistir na metade. Escolha um livro inteiro (comece por Romanos ou Marcos) e leia sequencialmente, do capítulo 1 até o final.</li>
                        <li><strong>Filtre o Seu Consumo:</strong> Ative o "espírito bereano" no seu dia a dia. Quando ouvir uma pregação ou um conselho religioso na internet, não engula imediatamente. Abra a sua Bíblia e confira se o pregador não está usando o versículo fora de contexto para te manipular. A verdade de Deus suporta qualquer investigação.</li>
                    </ul>
                </div>

                <button class="btn" onclick="iniciarProva('conhecimento')">Realizar Prova do Pilar 2</button>
            </section>

            <section id="mod-resultados" class="module-section">
                <h1>Boletim de Resultados e Histórico</h1>
                <p>O seu histórico de avaliações fica armazenado com segurança nesta página. Analise os detalhes de seus acertos e, principalmente, dos seus erros. O caráter não teme a correção da verdade.</p>
                <div id="resultados-lista">
                    <p style="color: #64748b; font-style: italic;">Nenhuma avaliação foi processada ainda. Faça as provas nos módulos para gerar seu boletim.</p>
                </div>
            </section>

            <section id="mod-exame" class="module-section">
                <h1>O Exame Final da Forja</h1>
                <p>Você chegou ao fim da fundamentação. Este exame final não é um teste fácil. Ele contém 30 perguntas vitais que percorrem todos os pilares ensinados, exigindo que você comprove o conhecimento adquirido.</p>
                <div class="step-box">
                    <h4>Regras de Certificação:</h4>
                    <ul class="step-list">
                        <li>A nota de corte obrigatória é de <strong>85% de acertos</strong>.</li>
                        <li>Se você falhar na pontuação, o sistema exigirá que você revise o material e refaça a prova amanhã.</li>
                        <li>Se aprovado com excelência, o motor irá gerar e baixar automaticamente o seu <strong>Certificado Oficial em PDF</strong> assinado.</li>
                    </ul>
                </div>
                <button class="btn btn-success" onclick="iniciarExameFinal()">Iniciar o Exame Final (30 Questões)</button>
            </section>

        </main>
    </div>

    <div id="eval-modal">
        <div class="eval-container" id="eval-quiz-stage">
            <h2 id="quiz-titulo" style="font-family: 'Merriweather', serif; font-size: 2rem; margin-bottom: 2rem; border-bottom: 2px solid var(--border); padding-bottom: 1rem;">Prova em Andamento</h2>
            <div id="quiz-render-area"></div>
            
            <p id="quiz-err" style="color: var(--danger); font-weight: 800; display: none; text-align: center; margin-top: 1rem; font-size: 1.1rem;">Aviso: Você não pode deixar questões em branco.</p>
            <button class="btn" onclick="finalizarProvaLocal()">Salvar Respostas e Verificar Nota</button>
            <button class="btn" style="background: transparent; border: 2px solid var(--border); color: var(--secondary); margin-top: 1rem;" onclick="closeEval()">Cancelar e Estudar Mais</button>
        </div>
    </div>

    <div id="certificado-wrapper">
        <div class="certificado-content">
            <h1 class="cert-title">A FÉ INABALÁVEL</h1>
            <p class="cert-subtitle">PROGRAMA OFICIAL DE FORMAÇÃO DE CARÁTER E TEOLOGIA</p>
            <h2 class="cert-name" id="cert-nome-display">NOME DO ALUNO</h2>
            <p class="cert-body">
                Certificamos para os devidos fins que o(a) aluno(a) acima, exercendo a função de <strong><span id="cert-funcao-display"></span></strong>, concluiu com excelência o treinamento prático e teórico, sendo aprovado(a) no Exame Final do curso <strong>A FÉ INABALÁVEL</strong> com pontuação superior à média exigida.<br><br>
                <em>"Produz fruto de justiça e paz para aqueles que por ela foram exercitados." (Hb 12:11)</em>
            </p>
            <div class="cert-footer">
                <div class="cert-signature">Instrutor Teológico e Mentor</div>
                <div class="cert-signature">Supervisão Acadêmica do Curso</div>
            </div>
        </div>
    </div>

    <script>
        // Variáveis de Estado
        let nomeAluno = "";
        let funcaoAluno = "";
        let moduloAtualProva = "";
        let questoesSorteadas = [];
        let isExameFinal = false;

        // BANCO DE QUESTÕES (Profundas, baseadas exatamente nos textos e passo a passo)
        const bancoAvaliacoes = {
            disciplina: [
                { q: "Qual a diferença central ensinada no curso entre a Falsa Motivação e a Verdadeira Disciplina?", opts: ["A motivação é ditada pelo humor e pelas circunstâncias; a disciplina é um compromisso racional inegociável que você cumpre independente do que está sentindo.", "A motivação é ruim e a disciplina é o único sentimento aceitável.", "Não existe diferença, as duas dependem de emoção.", "A disciplina só existe dentro do prédio da igreja."], ans: 0 },
                { q: "O apóstolo Paulo fala em 1 Coríntios 9 sobre 'esmurrar o próprio corpo'. O que essa passagem nos ensina sobre o Domínio da Carne?", opts: ["Que devemos nos agredir fisicamente para sermos perdoados pelos nossos pecados.", "Significa subjugar a vontade carnal (que exige conforto e prazer imediato) e declarar que quem governa suas decisões é o Espírito Santo.", "Que devemos jejuar sem beber água durante um ano.", "Que a vida cristã é igual a um campeonato de luta."], ans: 1 },
                { q: "Sobre a lição de 'Disciplina sob Pressão', o que o exemplo do profeta Daniel nos ensina quando o decreto de morte foi assinado na Babilônia?", opts: ["Que ele orou desesperadamente inventando uma nova forma de buscar a Deus por causa do pânico.", "Que a disciplina que ele construiu na paz serviu como armadura na guerra: ele foi orar 'como costumava fazer', mostrando que hábitos inquebráveis vencem o caos.", "Que ele negociou sua fé escondendo-se no porão para orar em silêncio.", "Que ele usou de violência para se defender dos leões."], ans: 1 },
                { q: "Na prática 'A Regra dos 5 Segundos', qual é o conselho fundamental para vencer a preguiça matinal?", opts: ["Ao soar o alarme, conte de 5 até 1 e levante imediatamente para não dar tempo da mente carnal argumentar a favor do conforto da cama.", "Ore por 5 segundos antes de levantar e depois volte a dormir.", "Coloque 5 alarmes diferentes para garantir que você acorde.", "Pense por 5 segundos em todos os seus problemas antes de sair da cama."], ans: 0 },
                { q: "Na 'Prática: O Jejum de Prazeres Lícitos', qual é o propósito de ficar 3 dias sem algo que rouba seu tempo (ex: redes sociais, açúcar)?", opts: ["Perder peso e economizar dinheiro.", "Mostrar aos irmãos do grupo de oração que você é extremamente espiritual.", "Informar ao seu corpo que ele não governa suas decisões, fortalecendo o músculo do autocontrole emocional ao redirecionar a fome e a frustração para Deus.", "Pagar uma penitência por um pecado cometido na semana anterior."], ans: 2 }
            ],
            conhecimento: [
                { q: "No hebraico e no grego, a Bíblia exige um conhecimento do tipo Yada/Ginosko. Qual é a definição exata desse conhecimento?", opts: ["Acúmulo de dados históricos para vencer debates teológicos na internet contra hereges.", "Um conhecimento puramente emocional, focado apenas em sentir a presença de Deus sem precisar ler a Bíblia.", "Um diploma universitário em teologia sistemática.", "Um conhecimento íntimo, relacional e de primeira mão sobre o caráter de Deus, gerado por convívio e estudo profundo."], ans: 3 },
                { q: "No deserto (Mateus 4), Satanás tentou Jesus usando o Salmo 91 fora de contexto para induzi-lo ao orgulho. Como Jesus derrotou essa mentira?", opts: ["Jesus expulsou Satanás com anjos de fogo, recusando-se a discutir a Palavra.", "Jesus puxou a espada do Conhecimento inquebrável, citando o livro de Deuteronômio ('Também está escrito'), provando que texto fora de contexto é heresia.", "Jesus concordou em pular do templo para provar que a promessa de proteção dos anjos era verdadeira.", "Jesus começou a orar de olhos fechados até o diabo ir embora por conta própria."], ans: 1 },
                { q: "Por que os cristãos da igreja de Bereia (Atos 17) foram chamados de pessoas com 'caráter nobre'?", opts: ["Porque eles ofertavam grandes quantias de dinheiro para as viagens de Paulo.", "Porque eles aceitavam cegamente e gritavam 'amém' para tudo o que Paulo, a maior autoridade teológica da época, dizia no púlpito.", "Porque eles recebiam a palavra com alegria, mas iam para casa examinar rigorosamente as Escrituras todos os dias para conferir se o que o apóstolo estava pregando era verdade.", "Porque eles nunca faziam perguntas, demonstrando fé absoluta."], ans: 2 },
                { q: "Na Prática do curso, por que a 'Leitura Aleatória' (abrir a Bíblia e apontar o dedo em qualquer página) deve ser abandonada?", opts: ["Porque amassa o meio da Bíblia.", "Porque a Bíblia é uma biblioteca. Ler versículos soltos fora do contexto da história original abre brechas para manipulação e heresias; a leitura deve ser sequencial.", "Porque Deus proibiu no livro do Apocalipse.", "O curso diz o contrário: a leitura aleatória é o único método aprovado por Deus."], ans: 1 },
                { q: "Qual é a técnica prática ensinada no 'Arsenal Mental Contra Tentações'?", opts: ["Assistir a 3 vídeos no YouTube sobre teologia todos os dias.", "Identificar sua pior fraqueza (ira, medo), escrever 3 versículos sobre o assunto, colá-los em um lugar visível e lê-los em voz alta até memorizá-los, para usar como arma quando a crise chegar.", "Fingir que o problema não existe e pensar positivo.", "Ligar para o pastor toda vez que sentir vontade de pecar."], ans: 1 }
            ]
        };

        // --- ENGENHARIA ANTI-FRAUDE E CHAVES ---
        function gerarAssinatura(nome, moduloNum) {
            let n = nome.trim().toLowerCase();
            let iniciais = n.split(/\s+/).map(p => p.charAt(0)).join('');
            let letras = n.replace(/\s+/g, '').length;
            let codigoBase = `${iniciais}${letras}-${moduloNum}`;
            return btoa(codigoBase + "-FORJA2026");
        }

        function extrairModuloDaChave(chaveInput, nomeAtual) {
            try {
                let decodificado = atob(chaveInput);
                if (!decodificado.endsWith("-FORJA2026")) return null;
                let partes = decodificado.replace("-FORJA2026", "").split('-');
                let assinBase = partes[0]; 
                let modNum = parseInt(partes[1]);
                let n = nomeAtual.trim().toLowerCase();
                let iniciais = n.split(/\s+/).map(p => p.charAt(0)).join('');
                let letras = n.replace(/\s+/g, '').length;
                let assinaturaEsperada = `${iniciais}${letras}`;
                if (assinBase !== assinaturaEsperada) return null; // A chave não pertence a esse nome
                return modNum;
            } catch (e) {
                return null;
            }
        }

        // --- INICIALIZAÇÃO E SISTEMA DE LOGIN ---
        function entrarNoCurso() {
            nomeAluno = document.getElementById('login-nome').value.trim();
            funcaoAluno = document.getElementById('login-funcao').value.trim();
            let chaveInput = document.getElementById('login-chave').value.trim();

            if (!nomeAluno || !funcaoAluno) {
                document.getElementById('login-err').innerText = "Você não pode avançar sem preencher Nome e Função.";
                document.getElementById('login-err').style.display = 'block';
                return;
            }

            document.getElementById('display-nome').innerText = nomeAluno;
            document.getElementById('display-funcao').innerText = funcaoAluno;

            let modLiberado = 1;

            if (chaveInput !== "") {
                let check = extrairModuloDaChave(chaveInput, nomeAluno);
                if (check === null) {
                    document.getElementById('login-err').innerText = "ERRO DE SEGURANÇA: Chave Inválida, adulterada ou não pertence ao seu nome.";
                    document.getElementById('login-err').style.display = 'block';
                    return;
                }
                modLiberado = check;
                document.getElementById('display-chave').innerText = chaveInput;
            } else {
                document.getElementById('display-chave').innerText = "NENHUMA";
            }

            // Lógica de Destravamento de Abas
            if (modLiberado >= 2) {
                document.getElementById('nav-mod-conhecimento').classList.remove('locked');
                document.getElementById('nav-mod-conhecimento').innerText = "2. Conhecimento";
            }
            if (modLiberado >= 3) { // Regra do Exame (No futuro será >= 8)
                document.getElementById('nav-mod-exame').classList.remove('locked');
                document.getElementById('nav-mod-exame').innerText = "Exame Final (Liberado)";
            }

            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app-layout').style.display = 'flex';
        }

        // --- MOTOR DE PROVAS (AVALIAÇÃO E EXAME FINAL) ---
        function iniciarProva(moduloID) {
            isExameFinal = false;
            moduloAtualProva = moduloID;
            let tituloStr = moduloID === 'disciplina' ? "Pilar 1: A Disciplina" : "Pilar 2: O Conhecimento";
            document.getElementById('quiz-titulo').innerText = "Avaliação de Formação | " + tituloStr;
            montarEExibirProva(bancoAvaliacoes[moduloAtualProva]);
        }

        function iniciarExameFinal() {
            isExameFinal = true;
            document.getElementById('quiz-titulo').innerText = "O Exame Final da Forja (30 Questões)";
            
            // O sistema mescla todas as questões e sorteia 30. (Nesta fase clonei as existentes para fechar a matemática de 30 para você testar).
            let todasAsQuestoes = [...bancoAvaliacoes.disciplina, ...bancoAvaliacoes.conhecimento];
            let poolExame = [];
            while(poolExame.length < 30) {
                let randomQ = todasAsQuestoes[Math.floor(Math.random() * todasAsQuestoes.length)];
                poolExame.push(JSON.parse(JSON.stringify(randomQ))); 
            }
            montarEExibirProva(poolExame);
        }

        function montarEExibirProva(arrayDeQuestoes) {
            document.getElementById('quiz-err').style.display = 'none';
            const container = document.getElementById('quiz-render-area');
            container.innerHTML = '';
            
            questoesSorteadas = [...arrayDeQuestoes].sort(() => 0.5 - Math.random());

            questoesSorteadas.forEach((qData, qIndex) => {
                let html = `<div class="question-card"><div class="question-title">${qIndex + 1}. ${qData.q}</div>`;
                
                let optsWithIndex = qData.opts.map((optText, origIndex) => ({ text: optText, val: origIndex }));
                optsWithIndex.sort(() => 0.5 - Math.random());

                optsWithIndex.forEach((opt) => {
                    html += `<label class="option-lbl"><input type="radio" name="ans-${qIndex}" value="${opt.val}"> <span>${opt.text}</span></label>`;
                });
                html += `</div>`;
                container.innerHTML += html;
            });
            
            document.getElementById('eval-modal').style.display = 'block';
            document.getElementById('eval-modal').scrollTop = 0;
        }

        function closeEval() { document.getElementById('eval-modal').style.display = 'none'; }

        function finalizarProvaLocal() {
            let acertos = 0;
            let total = questoesSorteadas.length;
            let todasRespondidas = true;
            let detalhamentoHTML = "";

            for (let i = 0; i < total; i++) {
                const selected = document.querySelector(`input[name="ans-${i}"]:checked`);
                if (!selected) { todasRespondidas = false; break; }
                
                let isCorrect = parseInt(selected.value) === questoesSorteadas[i].ans;
                if (isCorrect) {
                    acertos++;
                    detalhamentoHTML += `<div class="result-q">${i + 1}. ${questoesSorteadas[i].q}</div><div class="result-a correct">✅ CORRETA</div>`;
                } else {
                    detalhamentoHTML += `<div class="result-q">${i + 1}. ${questoesSorteadas[i].q}</div><div class="result-a incorrect">❌ INCORRETA (A resposta gravada estava incorreta, revise os textos das práticas).</div>`;
                }
            }

            if (!todasRespondidas) { document.getElementById('quiz-err').style.display = 'block'; return; }

            const percent = Math.round((acertos / total) * 100);

            if (isExameFinal) {
                // EXAME FINAL DE ALTA PERFORMANCE
                if (percent >= 85) {
                    alert(`EXAME FINAL: APROVADO! Você tirou ${percent}%. Você provou o seu conhecimento teológico. O sistema irá gerar e baixar automaticamente o seu Certificado Oficial em PDF. Confira seu histórico de resultados.`);
                    gerarCertificadoPDF();
                } else {
                    alert(`EXAME FINAL: REPROVADO. Você tirou apenas ${percent}%. A nota de corte é rigorosa: 85%. Retorne ao material, estude as escrituras e refaça a prova. A forja exige excelência.`);
                }
                closeEval();
                switchTab('mod-resultados');
                return;
            }

            // AVALIAÇÃO COMUM DOS MÓDULOS
            let tituloMod = moduloAtualProva === 'disciplina' ? "Pilar 1: A Disciplina" : "Pilar 2: O Conhecimento";
            
            let htmlResultado = `
                <div class="result-card">
                    <div class="result-header">
                        <h3>Correção da Avaliação: ${tituloMod}</h3>
                        <div class="result-score">Pontuação: ${percent}% (${acertos}/${total})</div>
                    </div>
                    ${detalhamentoHTML}
                </div>
            `;
            
            // Grava no Histórico Local
            const listaResult = document.getElementById('resultados-lista');
            if (listaResult.innerHTML.includes("Nenhuma avaliação foi processada")) { listaResult.innerHTML = ''; }
            listaResult.innerHTML = htmlResultado + listaResult.innerHTML; 

            if (percent >= 60) {
                if (moduloAtualProva === 'disciplina') {
                    document.getElementById('nav-mod-conhecimento').classList.remove('locked');
                    document.getElementById('nav-mod-conhecimento').innerText = "2. Conhecimento";
                    let novaChave = gerarAssinatura(nomeAluno, 2);
                    document.getElementById('display-chave').innerText = novaChave;
                    alert(`APROVADO no Pilar 1! Sua NOVA CHAVE ANTI-FRAUDE foi gerada na barra lateral. Copie-a! O Pilar 2 (Conhecimento) foi destravado. Confira seus acertos no Boletim.`);
                } else if (moduloAtualProva === 'conhecimento') {
                    document.getElementById('nav-mod-exame').classList.remove('locked');
                    document.getElementById('nav-mod-exame').innerText = "Exame Final (Liberado)";
                    let novaChave = gerarAssinatura(nomeAluno, 3);
                    document.getElementById('display-chave').innerText = novaChave;
                    alert(`APROVADO no Pilar 2! Excelente. Como etapa final do nosso teste, o 'Exame Final da Forja' foi Liberado no menu. Sua Chave Evolutiva foi atualizada.`);
                }
            } else {
                alert(`REPROVADO. Sua nota foi de ${percent}%. O alvo era 60%. O caráter não aceita desculpas. Estude as práticas detalhadas novamente e refaça a prova.`);
            }

            closeEval();
            switchTab('mod-resultados'); 
        }

        // --- SISTEMA GERADOR DE CERTIFICADO EM PDF ---
        function gerarCertificadoPDF() {
            // Imprime os dados no certificado invisível
            document.getElementById('cert-nome-display').innerText = nomeAluno.toUpperCase();
            document.getElementById('cert-funcao-display').innerText = funcaoAluno.toUpperCase();

            const element = document.getElementById('certificado-wrapper');
            element.style.display = 'block'; 
            
            // Parametrização para Alta Qualidade
            var opt = {
                margin:       0,
                filename:     `Certificado_Forja_${nomeAluno.replace(/\s+/g, '_')}.pdf`,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, logging: false },
                jsPDF:        { unit: 'px', format: [1123, 794], orientation: 'landscape' }
            };

            // Processa, Baixa e Esconde
            html2pdf().set(opt).from(element).save().then(() => {
                element.style.display = 'none'; 
                alert("Sucesso! O Download do seu Certificado PDF Oficial começou. Ele será salvo na pasta de downloads do seu aparelho.");
            });
        }

        // --- CONTROLE DE MENUS E NAVEGAÇÃO ---
        function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }
        function switchTab(tabId) {
            document.querySelectorAll('.module-section').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('nav-' + tabId).classList.add('active');
            window.scrollTo(0, 0);
            if (window.innerWidth <= 768) { document.getElementById('sidebar').classList.remove('open'); }
        }
        function switchTabIfUnlocked(tabId, element) {
            if (!element.classList.contains('locked')) { switchTab(tabId); }
        }
    </script>
</body>
</html>
